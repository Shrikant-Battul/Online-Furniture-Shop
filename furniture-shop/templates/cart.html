{% extends 'base.html' %}
{% block content %}
<h2>Cart</h2>

{% if messages %}
  <div class="alert">
    {% for m in messages %}<div>{{ m }}</div>{% endfor %}
  </div>
{% endif %}

{% if items %}
  <div class="cart-list">
    {% for it in items %}
      <div class="cart-row">
        <img class="cart-thumb" src="{{ it.image_url|default:'https://picsum.photos/seed/cart'|add:it.id|add:'/200/150' }}" alt="{{ it.name }}">
        <div class="cart-info">
          <div class="title">{{ it.name }}</div>
          <div class="muted">Qty: {{ it.qty }}</div>
        </div>
        <div class="cart-price">₹{{ it.price }}</div>
        <div class="cart-line">₹{{ it.line_total|floatformat:2 }}</div>
        <a class="button" href="/cart/remove/{{ it.id }}/">Remove</a>
      </div>
    {% endfor %}
  </div>
  <div class="cart-total">Total: <strong>₹{{ total|floatformat:2 }}</strong></div>
  <a class="button" href="/checkout/">Proceed to Checkout</a>
{% else %}
  <p>Your cart is empty.</p>
{% endif %}

<style>
.alert{max-width:820px;margin:10px 0;padding:10px 12px;border:1px solid #fecaca;background:#fee2e2;color:#991b1b;border-radius:8px}
.cart-list{display:flex;flex-direction:column;gap:10px;margin:12px 0}
.cart-row{display:grid;grid-template-columns:120px 1fr 100px 120px 120px;gap:10px;align-items:center;border:1px solid var(--border);background:var(--surface);padding:10px;border-radius:10px}
.cart-thumb{width:120px;height:90px;object-fit:cover;border-radius:8px;background:var(--surface-2)}
.cart-info .title{font-weight:600}
.cart-price,.cart-line{text-align:right}
.cart-total{margin-top:10px;font-size:18px}
@media (max-width:700px){
  .cart-row{grid-template-columns:100px 1fr 80px;grid-auto-rows:auto}
  .cart-line{display:none}
}
</style>
{% endblock %}
